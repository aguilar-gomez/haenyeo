library(ggplot2)

years_per_gen<-25
rates<-c(0,0,5.63513e-05,5.46532e-05,4.84748e-05,4.5067e-05,4.50011e-05,4.89342e-05,5.905e-05,7.47877e-05,9.70927e-05,0.000116071,0.000125162,0.00012575,0.000103764,6.63785e-05,4.23847e-05,2.35988e-05,2.05018e-05,2.38513e-05,2.43591e-05,2.77327e-05,3.90027e-05,6.56139e-05,6.29281e-05,4.01098e-05,4.39915e-05,2.61294e-05,2.60949e-05,4.58298e-05,0.000221865)
ratesKor<-c(1,1,2.22617e-05,2.5889e-05,2.6043e-05,2.80895e-05,3.26925e-05,4.10663e-05,5.49464e-05,7.40595e-05,9.83684e-05,0.000119091,0.000128352,0.00012781,0.000103622,6.71767e-05,4.25741e-05,2.37424e-05,2.02876e-05,2.38957e-05,2.44097e-05,2.78875e-05,3.90069e-05,6.55267e-05,6.30626e-05,4.00979e-05,4.40751e-05,2.63235e-05,2.58282e-05,4.74201e-05,0.000207807)
rates01<-c(1,0,2.36224e-05,2.66073e-05,2.61804e-05,2.77514e-05,3.19459e-05,3.95815e-05,5.2898e-05,7.18085e-05,9.62529e-05,0.000116848,0.000126519,0.00012674,0.000103729,6.67739e-05,4.24676e-05,2.36598e-05,2.03937e-05,2.38561e-05,2.43862e-05,2.78022e-05,3.90094e-05,6.55643e-05,6.29922e-05,4.00879e-05,4.39997e-05,2.62067e-05,2.59811e-05,4.63936e-05,0.000213472)
time<-c(0,40,55.5798,77.2279,107.308,149.104,207.179,287.874,400,555.798,772.279,1073.08,1491.04,2071.79,2878.74,4000,5557.98,7722.79,10730.8,14910.4,20717.9,28787.4,40000,55579.8,77227.9,107308,149104,207179,287874,400000,4e+06)

years_per_gen<-28
time<-c(0,35.7143,49.6248,68.9535,95.8106,133.128,184.981,257.031,357.143,496.248,689.535,958.106,1331.28,1849.81,2570.31,3571.43,4962.48,6895.35,9581.06,13312.8,18498.1,25703.1,35714.3,49624.8,68953.5,95810.6,133128,184981,257031,357143,3.57143e+06)
rates<-c(0,0,5.65925e-05,5.71324e-05,4.96134e-05,4.51592e-05,4.43762e-05,4.70407e-05,5.51284e-05,6.88925e-05,8.82391e-05,0.000111254,0.000124194,0.00012845,0.000112991,7.6362e-05,5.24379e-05,2.73801e-05,2.16055e-05,2.20491e-05,2.31898e-05,2.75608e-05,3.07457e-05,6.02006e-05,6.60761e-05,4.36462e-05,4.62631e-05,3.16999e-05,2.25202e-05,4.08942e-05,1.76984e-05,2.11951e-05)
rates01<-c(1,0,2.33291e-05,2.73211e-05,2.60367e-05,2.65204e-05,2.98322e-05,3.64081e-05,4.79183e-05,6.47145e-05,8.69402e-05,0.00011143,0.000125479,0.000129602,0.000113538,7.66513e-05,5.2341e-05,2.74976e-05,2.15295e-05,2.20925e-05,2.31985e-05,2.7593e-05,3.07601e-05,6.02232e-05,6.60399e-05,4.36331e-05,4.62321e-05,3.16894e-05,2.24851e-05,4.05152e-05,1.74445e-05,2.11775e-05)
ratesKor<-c(1,1,2.19859e-05,2.66015e-05,2.55726e-05,2.66001e-05,3.07066e-05,3.76576e-05,4.96046e-05,6.70903e-05,8.92517e-05,0.000113535,0.000127387,0.000131002,0.00011407,7.68087e-05,5.23791e-05,2.76057e-05,2.14778e-05,2.21278e-05,2.32048e-05,2.76382e-05,3.07934e-05,6.02558e-05,6.60136e-05,4.36348e-05,4.61943e-05,3.17433e-05,2.25638e-05,4.01512e-05,1.72044e-05,2.11949e-05)

years_per_gen<-27
time<-c(0,37.037,51.4628,71.5073,99.3591,138.059,191.832,266.55,370.37,514.628,715.073,993.591,1380.59,1918.32,2665.5,3703.7,5146.28,7150.73,9935.91,13805.9,19183.2,26655,37037,51462.8,71507.3,99359.1,138059,191832,266550,370370,3.7037e+06)
rates<-c(0,0,5.63964e-05,5.63407e-05,4.91277e-05,4.53449e-05,4.45812e-05,4.75679e-05,5.5922e-05,7.00955e-05,9.02234e-05,0.000112662,0.00012747,0.000124377,0.000108809,7.40756e-05,4.97235e-05,2.71239e-05,2.0656e-05,2.23041e-05,2.34026e-05,2.76329e-05,3.31104e-05,5.99672e-05,6.74662e-05,4.4137e-05,4.49434e-05,3.0435e-05,2.7711e-05,4.37002e-05,0.00222779)
rates01<-c(0,1,2.34249e-05,2.71316e-05,2.57901e-05,2.69681e-05,3.06962e-05,3.73343e-05,4.94118e-05,6.63904e-05,8.93996e-05,0.000112859,0.000128574,0.000125701,0.000109278,7.39488e-05,4.99323e-05,2.71411e-05,2.06978e-05,2.22748e-05,2.34236e-05,2.76628e-05,3.30973e-05,5.99952e-05,6.74386e-05,4.41705e-05,4.50048e-05,3.04292e-05,2.77109e-05,4.40391e-05,0.00230247)
ratesKor<-c(1,1,2.20347e-05,2.61935e-05,2.55668e-05,2.71478e-05,3.15461e-05,3.86573e-05,5.13361e-05,6.87343e-05,9.17812e-05,0.000115052,0.000130494,0.000127065,0.000109563,7.38741e-05,5.01779e-05,2.71455e-05,2.07739e-05,2.22769e-05,2.34565e-05,2.76745e-05,3.31062e-05,6.00198e-05,6.74461e-05,4.41952e-05,4.50732e-05,3.04664e-05,2.78245e-05,4.44327e-05,0.00238882)

Ne<-1/(2*rates)
pop_size=data.frame(time=time[2:31]*years_per_gen,pop_size=Ne[3:32])
small<-pop_size[pop_size$time<1e6,]


Ne<-1/(2*ratesKor)
pop_sizeKor=data.frame(time=time[2:31]*years_per_gen,pop_size=Ne[3:32])
smallKor<-pop_sizeKor[pop_sizeKor$time<1e6,]
hola<-cbind(pop_size,pop_sizeKor)
options(scipen = 999)

Ne<-1/(2*rates01)
pop_size01=data.frame(time=time[2:31]*years_per_gen,pop_size=Ne[3:32])
small01<-pop_size01[pop_size01$time<1e6,]

ggplot() + 
  geom_step(data = small, aes(time, pop_size, color = "JEJ-JEJ"), lwd = 1.2) +
  geom_step(data = small01, aes(time, pop_size, color = "JEJ-KOR"), lwd = 1.2) +
  geom_step(data = smallKor, aes(time, pop_size, color = "KOR-KOR"), lwd = 1.2) +
  scale_x_continuous(trans = "log10", labels = scales::trans_format("log10", scales::math_format(10^.x))) +
  annotation_logticks() +
  scale_y_continuous(trans = "log10") +
  ylab("Population size") +
  xlab("Years ago") +
  theme_bw() +
  theme(text = element_text(size = 16)) +
  scale_color_manual(values = c("JEJ-JEJ" = "#314F70", "KOR-KOR" = "#f29900","JEJ-KOR"="black"))+
  theme(legend.title = element_blank()) 


ggsave("PopsizeJejuKorJoint25generationAllsites.png",height=5,width=6)
ggsave("PopsizeJejuKorJoint27generationAllsites.png",height=5,width=6)
ggsave("PopsizeJejuKorJoint28generationAllsites.png",height=5,width=6)
